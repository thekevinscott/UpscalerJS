"use strict";(self.webpackChunk_upscalerjs_docs=self.webpackChunk_upscalerjs_docs||[]).push([[9527],{54852:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>d});var r=a(49231);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var p=r.createContext({}),l=function(e){var t=r.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=l(a),d=n,h=m["".concat(p,".").concat(d)]||m[d]||u[d]||i;return a?r.createElement(h,o(o({ref:t},c),{},{components:a})):r.createElement(h,o({ref:t},c))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=m;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:n,o[1]=s;for(var l=2;l<i;l++)o[l]=a[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},51022:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var r=a(74011),n=(a(49231),a(54852));const i={category:"Browser",hide_table_of_contents:!0,sidebar_position:101,parent:"performance",code_embed:{params:"embed=1&file=index.js&hideExplorer=1",type:"stackblitz",url:"/examples/warmup"}},o="Warming up models",s={unversionedId:"documentation/guides/browser/performance/warmup",id:"documentation/guides/browser/performance/warmup",title:"Warming up models",description:"View this page on the UpscalerJS website",source:"@site/docs/documentation/guides/browser/performance/warmup.md",sourceDirName:"documentation/guides/browser/performance",slug:"/documentation/guides/browser/performance/warmup",permalink:"/documentation/guides/browser/performance/warmup",draft:!1,tags:[],version:"current",sidebarPosition:101,frontMatter:{category:"Browser",hide_table_of_contents:!0,sidebar_position:101,parent:"performance",code_embed:{params:"embed=1&file=index.js&hideExplorer=1",type:"stackblitz",url:"/examples/warmup"}},sidebar:"documentationSidebar",previous:{title:"Patch Sizes",permalink:"/documentation/guides/browser/performance/patch-sizes"},next:{title:"Web Worker Integration",permalink:"/documentation/guides/browser/performance/webworker"}},p={},l=[{value:"Motivation",id:"motivation",level:2},{value:"Code",id:"code",level:2},{value:"Explicit patch size and padding",id:"explicit-patch-size-and-padding",level:3},{value:"Numeric sizes",id:"numeric-sizes",level:3}],c={toc:l};function u(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"warming-up-models"},"Warming up models"),(0,n.kt)("a",{class:"docs-link",href:"https://upscalerjs.com/documentation/guides/browser/performance/warmup"},"View this page on the UpscalerJS website"),(0,n.kt)("p",null,"This guide demonstrates how to make calls to UpscalerJS process faster."),(0,n.kt)("a",{href:"https://stackblitz.com/github/thekevinscott/upscalerjs/tree/main/examples/warmup?file=index.js&title=UpscalerJS: Warmup Example"},"Open in Stackblitz"),".",(0,n.kt)("h2",{id:"motivation"},"Motivation"),(0,n.kt)("p",null,"The first time a model is run in Tensorflow.js, ",(0,n.kt)("a",{parentName:"p",href:"https://www.tensorflow.org/js/guide/platform_environment#shader_compilation_texture_uploads"},"its inference speed can be slow"),":"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"TensorFlow.js executes operations on the GPU by running WebGL shader programs. These shaders are assembled and compiled lazily when the user asks to execute an operation. The compilation of a shader happens on the CPU on the main thread and can be slow. TensorFlow.js will cache the compiled shaders automatically, making the second call to the same operation with input and output tensors of the same shape much faster. Typically, TensorFlow.js applications will use the same operations multiple times in the lifetime of the application, so the second pass through a machine learning model is much faster.")),(0,n.kt)("p",null,"If we know we'll be doing multiple upscales, we can first warm up our model, which will make subsequent upscaling operations much faster."),(0,n.kt)("h2",{id:"code"},"Code"),(0,n.kt)("p",null,"We can warm up an UpscalerJS model by calling ",(0,n.kt)("inlineCode",{parentName:"p"},"warmup"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"import Upscaler from 'upscaler'\n\nconst upscaler = new Upscaler()\n\nupscaler.warmup({ patchSize: 64, padding: 2 }).then(() => {\n  console.log('All warmed up')\n})\n")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"/documentation/api/warmup"},(0,n.kt)("inlineCode",{parentName:"a"},"warmup")," can be called a few different ways"),"."),(0,n.kt)("h3",{id:"explicit-patch-size-and-padding"},"Explicit patch size and padding"),(0,n.kt)("p",null,"We can pass an object with a specific patch size and padding, like:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"upscaler.warmup({ patchSize: 64, padding: 2 })\n")),(0,n.kt)("p",null,"We can also pass this as an array if we need to warm up multiple sizes, like:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"upscaler.warmup([{ patchSize: 64, padding: 2 }, { patchSize: 32, padding: 2 }])\n")),(0,n.kt)("h3",{id:"numeric-sizes"},"Numeric sizes"),(0,n.kt)("p",null,"Alternatively, we can explicitly provide the width and height as numbers (width first):"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"upscaler.warmup([64, 64])\n")),(0,n.kt)("p",null,"We can also pass this as an array if we need to warm up multiple sizes, like:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-javascript"},"upscaler.warmup([[64, 64], [32, 32]])\n")))}u.isMDXComponent=!0}}]);